#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Backend checks
echo "ğŸ“¦ Building backend..."
cd apps/backend
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Backend build failed!"
  exit 1
fi

# TODO: Fix tests before re-enabling
# echo "ğŸ§ª Running backend tests..."
# npm test
# if [ $? -ne 0 ]; then
#   echo "âŒ Backend tests failed!"
#   exit 1
# fi

cd ../..

# Frontend checks
echo "ğŸ“¦ Building frontend..."
cd apps/frontend
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Frontend build failed!"
  exit 1
fi

# TODO: Add frontend tests
# if [ -f "playwright.config.ts" ]; then
#   echo "ğŸ§ª Running frontend tests..."
#   npm test
#   if [ $? -ne 0 ]; then
#     echo "âŒ Frontend tests failed!"
#     exit 1
#   fi
# fi

cd ../..

echo "âœ… Build checks passed! (Tests temporarily disabled - TODO: fix)"
